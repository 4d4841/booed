<link rel="import" href="mg-badge-button.html">

<dom-module id="mg-user-button">
  <template strip-whitespace>
    <style>
      .avatar {
        width:28px;
        height:28px;
        border-radius: 50% 50%;
        background-color: rgba(0,0,0,0.1);
/*        border: 1.2px dashed tomato; */
        box-sizing: border-box;
        border-top: none;
        position: absolute;
        right: 6px;
        bottom: 6px;
        padding: 1px;
        pointer-events: none;
      }

    </style>

    <dom-if id="avatar" if="[[image]]">
  <template>
    <img class="avatar" src="[[image]]"></img>
  </template>
    </dom-if>


  </template>
  <script>
  (function() {
  let memoizedTemplate;

    class MGUserButton extends MGBadgeButton {
      static get is() { return 'mg-user-button'; }

      static get template() {
        if (!memoizedTemplate) {
          memoizedTemplate = Polymer.DomModule.import(this.is, 'template');
          let superTemplateContents = document.importNode(MGBadgeButton.template.content, true);
          let avatar = memoizedTemplate.content.querySelector('#avatar');
          memoizedTemplate.content.insertBefore(superTemplateContents, avatar);
        }
        return memoizedTemplate;
      }

      static get properties() { return {
        icon: {
          type: String,
          value: "ghost"
        },
        image: {
          type: String,
        },
        pathStyle: {
          type: String,
          value: "fill:tomato;fill-rule:evenodd;opacity:0.9"
        },
        me: {
          type: Object,
        }
      }}

      static get observers() { return [
        '_avatarChanged(me.User.photoURL)',
      ]}

      _avatarChanged(photoURL) {
        if (photoURL) {
          this.icon = null;
          this.image = photoURL;
        }
        else {
          this.icon = "ghost";
          this.image = null;
        }
      }

    }

    customElements.define(MGUserButton.is, MGUserButton);
  })();
  </script>
</dom-module>
