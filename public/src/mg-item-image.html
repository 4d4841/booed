<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="../bower_components/neon-animation/web-animations.html">
<link rel="import" href="mg-common-styles.html">

<dom-module id="mg-item-image">
  <template strip-whitespace>
      <custom-style>
    <style include="mg-common-styles iron-flex iron-flex-alignment">
      :host {
        margin: 5px;
      }

      .photo-thumbnail {
        width: 100%;
        height: 100%;
        background-color: whitesmoke;
      }

      .photo {
        width: 100%;
        height: 100%;
        text-decoration: none;
        padding: 0;
        margin: 5px;
        border-radius: 5px;
        @apply(--layout-vertical);
        box-shadow: 1px 1px 2px var(--app-shadow-color);
        background-color: white;
        overflow: hidden;
        border: 2px solid white;
      }

      paper-progress {
        width: 90%;
        pointer-events: none;
        position: absolute;
        top: 5px;
      }

      .label {
        width: 100%;
        text-transform: none;
        white-space: nowrap;
        position: absolute;
        bottom: 0;
        /*background-color: rgba(255,255,255,0.85);*/
        color: black;
        background: linear-gradient( transparent 0, whitesmoke 15px)
                    ,linear-gradient( transparent 0, whitesmoke 15px);
        height: 20px;
        line-height: 25px;
        z-index: 1;
        vertical-align: text-bottom;
        text-align: center;
      }

    </style>
      </custom-style>

    <paper-button class="photo" on-click="_onThumbClick">
      <iron-image
        class="photo-thumbnail"
        src="[[src]]"
        sizing="cover"
        placeholder="images/logo-pumpkin-grayout.svg"
        preload
        fade
      ></iron-image>
      <template is="dom-if" if="{{showProgress}}">
        <paper-progress
          value="[[progress]]"
        ></paper-progress>
      </template>

      <div class="label">[[name]]</div>
    </paper-button>
    <paper-tooltip animation-delay="500">[[name]]</paper-tooltip>

  </template>
  <script>
    class MGItemImage extends Polymer.Element {
      static get is() { return 'mg-item-image'; }

      static get properties() { return {
        src: {
          type: String,
          value: "",
        },

        progress: {
          type: Number,
        },

        showProgress: {
          type: Boolean,
          computed: '_computeShowProgress(progress)',
        },

        /*
        visible: {
          type: Boolean,
          value: false,
        },
        */
      }}

      static get observers() { return [
      ]}

      _computeShowProgress(progress) {
        if (typeof(progress) == "undefined") return false;
        if (progress == 100) return false;
        return true;
      }
    }

    customElements.define(MGItemImage.is, MGItemImage);
  </script>
</dom-module>
