<!DOCTYPE html>
<!--
 .................................................................................................
:::BSDB'::BSDB'::BSDB':::::BSDB':::BSDBS'::BSDBS'::BSDB'::::BSD'::BSDBS'::BSDBS'::BSDB'::::::BSD'::
::BSDBSD BSDBSD :.BSDBS':BSDBS .:BSD ..BSD  ...BSD 'BSDBS':BSD .BSD ..BSD  ...BSD :BSDBS'::BSDB .::
::COPYRIGHT2017 ::.BS BSDB .BS :BSD .::.BSD :::.BSD :BS .BSDB .BSD .:::BSD ::::BSD :BS BSDB BS .:::
:::BSDSTYLEBSD .:::BS  BS .:BS :BSD ::::BSD ::::BSD :BS ::BSD :BSD :::::...::::BSD :BS :BS  BS ::::
::::.LICENSE .::::BSD .:..::BS 'BSD ::::BSD ::::BSD :BS :::BS :BSD ::BSDBS'::::BSD :BS ::..:BS ':::
:::::::BSD .::::BSDB .::::::BSD 'BSD'::BSD .:::BSD .BSD :::BSD':BSD'::.BSD :::BSD .BSD :::::BSDB'::
::::::::B .::::::BS .:::::::.BSD ::BSDBS .:BSDBS  :BSD .::::BSD :.BSDBS BS BSDB .:BSD .:::::.BS .::
`::::::::.::::::::..::::::::::...:::.....:::.....:::...::::::...:::.............:::...::::::::..::'
-->

<link rel="import" href="mg-thumbnail.html">

<dom-module id="mg-item-image">
  <template strip-whitespace>
      <custom-style>
    <style include="mg-common-styles iron-flex iron-flex-alignment">
      :host {
      }

    </style>
      </custom-style>

  <mg-thumbnail
    src="[[src]]"
    progress="[[progress]]"
    icon="photo"
    label="[[name]]"
    selection-order="[[selectionOrder]]"
    deleted$="[[deleted]]"
    placeholder='images/logo-pumpkin-outline-grayout.svg'
    transition="1.5s"
    spinner
  >
    <slot></slot>
  </mg-thumbnail>

  </template>
  <script>
    class MGItemImage extends Polymer.GestureEventListeners(Polymer.Element) {
      static get is() { return 'mg-item-image'; }

      static get properties() { return {
        thumbnail: {
          type: String,
          value: '',
          observer: '_thumbnailChanged',
        },

        name: String,

      }}

      static get observers() { return [
      ]}

      _thumbnailChanged(repKey) {
        if (repKey) {
          this.set('src',null);
          let uid = MGAPP.AU.currentUser.uid;
          let storageRef = MGAPP.ST.ref('UID').child(uid).child('DATA');
          MGAPP.registerRepresentation(storageRef.child(repKey), (key,ev,val) => {
            ev === 'src' && repKey == this.thumbnail && this.set('src',val);
          });
        }
        else {
          this.set('src','images/logo-pumpkin-outline-grayout.svg');
        }
      }
    }

    customElements.define(MGItemImage.is, MGItemImage);
  </script>
</dom-module>
